<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="homepage.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <title>Stalls Info</title>
</head>
<body class="d-flex flex-column min-vh-100">

    <!-- Navbar (same as homepage for consistency) -->
    <header>
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container">
                <a class="navbar-brand" href="homepage.html">EasyEat</a>
            </div>
        </nav>
    </header>

    <!-- Hawker Centre Name -->
    <div class="container mt-4">
        <h2 id="hawkerTitle" class="text-center fw-bold">Hawker Centre Name</h2>
    </div>

    <!-- Stalls Section -->
    <div class="container mt-4" id="stallsContainer">
        <!-- JS will populate stall cards here -->
    </div>

    <!-- Back Button -->
    <div class="container text-center mt-4 mb-4">
        <a href="homepage.html" class="btn btn-outline-secondary">Back to Search</a>
    </div>

    <!-- Footer -->
    <footer class="py-3 mt-auto" style="background-color: bisque">
        <div class="container text-center">
            <p>Making your hawker centre experience better and quick access</p>
        </div>
    </footer>

    <!-- JS to populate stalls -->
    <script>
        // Fetch selected hawker name from URL
        function getHawkerFromURL() {
            const params = new URLSearchParams(window.location.search);
            return params.get('hawker'); // returns null if not found
        }

        const hawkerName = getHawkerFromURL();

        if(!hawkerName){
            alert("No hawker centre selected. Returning to homepage.");
            window.location.href = "homepage.html";
        }

        document.getElementById('hawkerTitle').textContent = hawkerName;

        // Fetch stalls and Menu info 
        axios.get('testing1.json')
            .then(response => {
                const data = response.data;
                const hawker = data.find(h => h.hawker === hawkerName);

                if(!hawker || !hawker.stalls.length){
                    document.getElementById('stallsContainer').innerHTML = "<p class='text-center'>No stalls found for this hawker centre.</p>";
                    return;
                }

                const container = document.getElementById('stallsContainer');
                container.innerHTML = ''; // clear container

                hawker.stalls.forEach(stall => {
                    // Create card
                    const card = document.createElement('div');
                    card.className = "card mb-3";

                    const cardBody = document.createElement('div');
                    cardBody.className = "card-body";

                    // Stall name
                    const stallName = document.createElement('h5');
                    stallName.className = "card-title";
                    stallName.textContent = stall.name;

                    // Menu list
                    const menuList = document.createElement('ul');
                    menuList.className = "list-group list-group-flush";

                    stall.menu.forEach(item => {
                        const li = document.createElement('li');
                        li.className = "list-group-item";
                        li.textContent = `${item.item} - $${item.price}`;
                        menuList.appendChild(li);
                    });

                    cardBody.appendChild(stallName);
                    card.appendChild(cardBody);
                    card.appendChild(menuList);
                    container.appendChild(card);
                });
            })
            .catch(error => console.error(error));
    </script>

    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

</body>
</html>
